!function(){"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t{constructor(t,s){e(this,"_hasInvalidInput",(e=>e.some((e=>!e.validity.valid)))),e(this,"_toggleButtonState",(()=>{this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0),this._buttonElement.setAttribute("style","cursor:not-allowed")):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"),this._buttonElement.setAttribute("style","cursor: pointer"))})),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=s,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector("#".concat(e.id,"-error"));s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_setInputsEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setInputsEventListeners()}}class s{constructor(e){var t,s;s=e=>{"Escape"===e.key&&this.close()},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("popup_active"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_active"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_active")||e.target.classList.contains("popup__exit-icon"))&&this.close()}))}}class i extends s{constructor(e,t){super(e),this._formPopupElement=this._popupElement.querySelector(".popup__form"),this._submitBtn=this._formPopupElement.querySelector(".popup__form-submit-btn"),this._inputList=this._formPopupElement.querySelectorAll(".popup__form-input"),this._submitHandler=t}getInputValues(){const e={};return this._inputList.forEach((t=>{const s=t.name;e[s]=t.value})),e}setEventListeners(){super.setEventListeners(),this._formPopupElement.addEventListener("submit",(e=>{e.preventDefault(),this._renderLoading(),this._submitHandler()}))}_renderLoading(){this._submitBtn.diabled=!0,this._submitBtn.textContent="Saving...",this._submitBtn.setAttribute("style","cursor:not-allowed")}getBtn(){return this._submitBtn}close(){super.close(),this._formPopupElement.reset()}}const n=".elements__list",r=".profile__name",o=".profile__role",l=(document.querySelector(n),document.querySelector(".profile__edit-btn")),a=document.querySelector(".profile__add-btn"),c=document.querySelector("#inputName"),h=document.querySelector("#inputRole"),u=(document.querySelector(r),document.querySelector(o),document.querySelector(".elements__likesNumber"),document.querySelector(".profile__imageContainer"));document.querySelector(".profile__image");class _{constructor(e,t,s){let{likedBolVal:i,ownerId:n,text:r,image:o,id:l,likesNum:a,handleCardClick:c,openDeleteConfirmPopUp:h,handleLike:u,handleDeleteLike:_}=e;this._text=r,this._image=o,this._templateSelector=t,this._handleCardClick=c,this._openDeleteConfirmPopUp=h,this._element=this._getTemplate(),this._imageItem=this._element.querySelector(".elements__image"),this._textItem=this._element.querySelector(".elements__text"),this._deleteItem=this._element.querySelector(".elements__delete-icon"),this._likeNumberItem=this._element.querySelector(".elements__likesNumber"),this._likeItem=this._element.querySelector(".elements__like-btn"),this._id=l,this._userId=s,this._ownerId=n,this._likesNum=a,this._likedBolVal=i,this._handleLike=u,this._handleDeleteLike=_}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".elements__element").cloneNode(!0)}generateCard(){return this._imageItem.src=this._image,this._textItem.textContent=this._text,this._imageItem.alt="view of ".concat(this._text),this._likeNumberItem.textContent=this._likesNum,this.setEventListeners(),this._likedBolVal&&this.toggleLikeButton(),this._userId!==this._ownerId&&this._deleteItem.setAttribute("style","display:none"),this._element}setEventListeners(){this._imageItem.addEventListener("click",(()=>{this._handleCardClick()})),this._likeItem.addEventListener("click",(()=>{this._likeItem.classList.contains("elements__svg-heart_liked")?this._handleDeleteLike(this):this._handleLike(this)})),this._deleteItem.addEventListener("click",(()=>{this.openDeleteConfirmPopUp()}))}openDeleteConfirmPopUp(){this._openDeleteConfirmPopUp(this._id)}deleteDomCard(){this._element.remove()}getId(){return this._id}toggleLikeButton(){this._likeItem.classList.toggle("elements__svg-heart_liked")}updateLikes(e){this._likeNumberItem.textContent=e}}const d=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkResponse)}postNewCard(e,t){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}confirmDelete(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}deleteLike(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._checkResponse)}getUserInfo(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkResponse)}editUserInfo(e){let{form__name:t,form__role:s}=e;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._checkResponse)}editAvatarImage(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}_checkResponse(e){return e.ok?e.json():Promise.reject("Error ".concat(e.status))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"d117ca4c-01ef-4f19-abee-387b4e32e69d","Content-Type":"application/json"}}),m=new class{constructor(e,t){let{data:s,renderer:i}=e;this._container=document.querySelector(t),this._items=s,this._renderer=i}renderer(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({data:[],renderer:e=>{m.addItem(cardRenderer(e))}},n),p=new i("#addImage",(function(){const e=p.getInputValues(),t=e.form__title,s=e.form__imageLink,i={};i.name=t,i.link=s,d.postNewCard(t,s).then((e=>{i.ownerId=e.owner._id,i._id=e._id,i.likes=e.likes,m.addItem(L(i)),p.close()})).catch(console.log).finally((()=>{const e=p.getBtn();e.textContent="Create",e.setAttribute("style","cursor:pointer")}))})),f=new i("#editProfileImage",(function(){const e=f.getInputValues().form__imageLink;d.editAvatarImage(e).then((e=>{f.close(),v.setUserInfo(e)})).catch((e=>{console.log(e)})).finally((()=>{const e=f.getBtn();e.textContent="Save",e.setAttribute("style","cursor:pointer")}))})),g=new i("#editProfile",(function(){const e=g.getInputValues();d.editUserInfo(e).then((e=>{g.close(),v.setUserInfo(e)})).catch(console.log).finally((()=>{const e=g.getBtn();e.textContent="Save",e.setAttribute("style","cursor:pointer")}))})),b=new class extends s{constructor(e){super(e),this._formPopupElement=this._popupElement.querySelector(".popup__form")}deleteAction(e){this._submitHandler=e}setEventListeners(){super.setEventListeners(),this._formPopupElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()}))}}("#confirmDelete"),E=new class extends s{constructor(e){var t,s;super(e),s=(e,t)=>{this._imageFile.src=e,this._imageText.textContent=t,this._imageFile.alt="view of ".concat(t),super.open()},(t="open")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this.open=s,this._imageFile=this._popupElement.querySelector(".popup__imagePopUp"),this._imageText=this._popupElement.querySelector(".popup__imagePopUp-text")}}("#imagePopUp"),v=new class{constructor(e){let{nameSelector:t,roleSelector:s,avatarSelector:i,userId:n}=e;this._profileName=document.querySelector(t),this._profileRole=document.querySelector(s),this._avatarImage=document.querySelector(i)}getUserInfo(){const e={};return e.name=this._profileName.textContent,e.role=this._profileRole.textContent,e}setUserInfo(e){this._profileName.textContent=e.name,this._profileRole.textContent=e.about,this._avatarImage.src=e.avatar}}({nameSelector:r,roleSelector:o,avatarSelector:".profile__image"}),k={};var I;I={inputSelector:".popup__form-input",submitButtonSelector:".popup__form-submit-btn",inactiveButtonClass:"popup__form-submit-btn_inactive",inputErrorClass:"popup__form-errorMsg",errorClass:"popup__form-errorMsg_active",formSelector:".popup__form"},Array.from(document.querySelectorAll(I.formSelector)).forEach((e=>{const s=new t(I,e),i=e.getAttribute("name");k[i]=s,s.enableValidation()})),g.setEventListeners(),p.setEventListeners(),f.setEventListeners(),b.setEventListeners(),E.setEventListeners();const L=e=>{const t=e.ownerId?e.ownerId:e.owner._id,s=e.name,i=e.link;let n=e.likes.length;const r=e._id;let o=!1;e.likes.forEach((e=>{if(e._id===y)return o=!0,o}));const l=new _({likedBolVal:o,ownerId:t,text:s,image:i,id:r,likesNum:n,handleCardClick:()=>{(e=>{e.open(i,s)})(E)},openDeleteConfirmPopUp:e=>{b.open(),b.deleteAction((()=>{d.confirmDelete(e).then((e=>{l.deleteDomCard(),b.close()})).catch(console.log)}))},handleLike:e=>{!function(e){d.likeCard(e.getId()).then((t=>{e.updateLikes(t.likes.length),e.toggleLikeButton()})).catch((e=>{console.log(e)}))}(e)},handleDeleteLike:e=>{!function(e){d.deleteLike(e.getId()).then((t=>{e.updateLikes(t.likes.length),e.toggleLikeButton()})).catch((e=>{console.log(e)}))}(e)}},"#card-template",y);return l.generateCard()};let y;Promise.all([d.getUserInfo(),d.getInitialCards()]).then((e=>{let[t,s]=e;y=t._id,Array.from(s).forEach((e=>{m.addItem(L(e))})),console.log(t),v.setUserInfo(t)})).catch(console.log),l.addEventListener("click",(()=>{const e=v.getUserInfo();c.setAttribute("value",e.name),h.setAttribute("value",e.role),k.edit__form.resetValidation(),g.open()})),a.addEventListener("click",(()=>{k.add__form.resetValidation(),p.open()})),u.addEventListener("click",(()=>{k.editProfileImage__form.resetValidation(),f.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoiaUpBQWUsTUFBTUEsRUFDbkJDLFlBQVlDLEVBQVVDLEdBQWEsMkJBdUNmQyxHQUNYQSxFQUFVQyxNQUFNQyxJQUNiQSxFQUFhQyxTQUFTQyxVQXpDQyw2QkE2Q2QsS0FDZkMsS0FBS0MsaUJBQWlCRCxLQUFLRSxhQUM3QkYsS0FBS0csZUFBZUMsVUFBVUMsSUFBSUwsS0FBS00sc0JBQ3ZDTixLQUFLRyxlQUFlSSxhQUFhLFlBQVksR0FDN0NQLEtBQUtHLGVBQWVJLGFBQWEsUUFBUyx3QkFFMUNQLEtBQUtHLGVBQWVDLFVBQVVJLE9BQU9SLEtBQUtNLHNCQUMxQ04sS0FBS0csZUFBZU0sZ0JBQWdCLFlBQ3BDVCxLQUFLRyxlQUFlSSxhQUFhLFFBQVMsdUJBcEQ1Q1AsS0FBS1UsZUFBaUJqQixFQUFTa0IsY0FDL0JYLEtBQUtZLHNCQUF3Qm5CLEVBQVNvQixxQkFDdENiLEtBQUtNLHFCQUF1QmIsRUFBU3FCLG9CQUNyQ2QsS0FBS2UsaUJBQW1CdEIsRUFBU3VCLGdCQUNqQ2hCLEtBQUtpQixZQUFjeEIsRUFBU3lCLFdBQzVCbEIsS0FBS21CLGFBQWV6QixFQUNwQk0sS0FBS0UsV0FBYWtCLE1BQU1DLEtBQ3RCckIsS0FBS21CLGFBQWFHLGlCQUFpQnRCLEtBQUtVLGlCQUUxQ1YsS0FBS0csZUFBaUJILEtBQUttQixhQUFhSSxjQUN0Q3ZCLEtBQUtZLHVCQUlUWSxnQkFBZ0IzQixFQUFjNEIsR0FDNUIsTUFBTUMsRUFBZTFCLEtBQUttQixhQUFhSSxjQUFsQixXQUNmMUIsRUFBYThCLEdBREUsV0FHckJELEVBQWFFLFlBQWNILEVBQzNCQyxFQUFhdEIsVUFBVUMsSUFBSUwsS0FBS2lCLGFBR2xDWSxnQkFBZ0JoQyxHQUNkLE1BQU02QixFQUFlMUIsS0FBS21CLGFBQWFJLGNBQWxCLFdBQ2YxQixFQUFhOEIsR0FERSxXQUdyQkQsRUFBYXRCLFVBQVVJLE9BQU9SLEtBQUtpQixhQUNuQ1MsRUFBYUUsWUFBYyxHQUc3QkUsb0JBQW9CakMsR0FDYkEsRUFBYUMsU0FBU0MsTUFHekJDLEtBQUs2QixnQkFBZ0JoQyxHQUZyQkcsS0FBS3dCLGdCQUFnQjNCLEVBQWNBLEVBQWFrQyxtQkF3QnBEQywyQkFDRWhDLEtBQUtFLFdBQVcrQixTQUFTcEMsSUFDdkJBLEVBQWFxQyxpQkFBaUIsU0FBUyxLQUNyQ2xDLEtBQUs4QixvQkFBb0JqQyxHQUN6QkcsS0FBS21DLDJCQUtYQyxrQkFDRXBDLEtBQUtFLFdBQVcrQixTQUFTcEMsSUFDdkJHLEtBQUs2QixnQkFBZ0JoQyxNQUV2QkcsS0FBS21DLHFCQUdQRSxtQkFDRXJDLEtBQUttQixhQUFhZSxpQkFBaUIsVUFBV0ksSUFDNUNBLEVBQUlDLG9CQUVOdkMsS0FBS2dDLDRCQzlFTSxNQUFNUSxFQUNuQmhELFlBQVlpRCxHLFVBY09ILElBQ0QsV0FBWkEsRUFBSUksS0FDTjFDLEtBQUsyQyxVLEVBaEJrQiwwQixzQkFBQSxLLHVEQUFBLEssS0FDekIzQyxLQUFLNEMsY0FBZ0JDLFNBQVN0QixjQUFja0IsR0FHOUNLLE9BQ0U5QyxLQUFLNEMsY0FBY3hDLFVBQVVDLElBQUksZ0JBQ2pDd0MsU0FBU1gsaUJBQWlCLFVBQVdsQyxLQUFLK0MsaUJBRzVDSixRQUNFM0MsS0FBSzRDLGNBQWN4QyxVQUFVSSxPQUFPLGdCQUNwQ3FDLFNBQVNHLG9CQUFvQixVQUFXaEQsS0FBSytDLGlCQVMvQ0Usb0JBQ0VqRCxLQUFLNEMsY0FBY1YsaUJBQWlCLGFBQWNnQixLQUU5Q0EsRUFBRUMsT0FBTy9DLFVBQVVnRCxTQUFTLGlCQUM1QkYsRUFBRUMsT0FBTy9DLFVBQVVnRCxTQUFTLHNCQUU1QnBELEtBQUsyQyxZQ3pCRSxNQUFNVSxVQUFzQmIsRUFDekNoRCxZQUFZaUQsRUFBZWEsR0FDekJDLE1BQU1kLEdBQ056QyxLQUFLd0Qsa0JBQW9CeEQsS0FBSzRDLGNBQWNyQixjQUFjLGdCQUMxRHZCLEtBQUt5RCxXQUFhekQsS0FBS3dELGtCQUFrQmpDLGNBQ3ZDLDJCQUVGdkIsS0FBS0UsV0FDSEYsS0FBS3dELGtCQUFrQmxDLGlCQUFpQixzQkFDMUN0QixLQUFLMEQsZUFBaUJKLEVBR3hCSyxpQkFDRSxNQUFNQyxFQUFjLEdBS3BCLE9BSkE1RCxLQUFLRSxXQUFXK0IsU0FBUzRCLElBQ3ZCLE1BQU1uQixFQUFNbUIsRUFBTUMsS0FDbEJGLEVBQVlsQixHQUFPbUIsRUFBTUUsU0FFcEJILEVBR1RYLG9CQUNFTSxNQUFNTixvQkFDTmpELEtBQUt3RCxrQkFBa0J0QixpQkFBaUIsVUFBV2dCLElBQ2pEQSxFQUFFWCxpQkFDRnZDLEtBQUtnRSxpQkFDTGhFLEtBQUswRCxvQkFJVE0saUJBQ0loRSxLQUFLeUQsV0FBV1EsU0FBVSxFQUMxQmpFLEtBQUt5RCxXQUFXN0IsWUFBYyxZQUM5QjVCLEtBQUt5RCxXQUFXbEQsYUFBYSxRQUFTLHNCQUcxQzJELFNBQ0UsT0FBT2xFLEtBQUt5RCxXQUdkZCxRQUNFWSxNQUFNWixRQUNOM0MsS0FBS3dELGtCQUFrQlcsU0M1QzNCLE1BQ01DLEVBQWtCLGtCQUNsQkMsRUFBZSxpQkFDZkMsRUFBZSxpQkFHZkMsR0FEb0IxQixTQUFTdEIsY0FBYzZDLEdBQzFCdkIsU0FBU3RCLGNBQWMsdUJBQ3hDaUQsRUFBZ0IzQixTQUFTdEIsY0FBYyxxQkFDdkNrRCxFQUFZNUIsU0FBU3RCLGNBQWMsY0FDbkNtRCxFQUFZN0IsU0FBU3RCLGNBQWMsY0FJbkNvRCxHQUhXOUIsU0FBU3RCLGNBQWM4QyxHQUN2QnhCLFNBQVN0QixjQUFjK0MsR0FDbkJ6QixTQUFTdEIsY0FBYywwQkFDbkJzQixTQUFTdEIsY0FBYyw2QkFDM0JzQixTQUFTdEIsY0FBYyxtQkNkN0IsTUFBTXFELEVBQ25CcEYsWUFBWSxFQUEySHFGLEVBQWtCQyxHQUFRLElBQXJKLFlBQUVDLEVBQUYsUUFBZUMsRUFBZixLQUF3QkMsRUFBeEIsTUFBOEJDLEVBQTlCLEdBQXFDdkQsRUFBckMsU0FBeUN3RCxFQUF6QyxnQkFBbURDLEVBQW5ELHVCQUFvRUMsRUFBcEUsV0FBNEZDLEVBQTVGLGlCQUF3R0MsR0FBNkMsRUFDL0p2RixLQUFLd0YsTUFBUVAsRUFDYmpGLEtBQUt5RixPQUFTUCxFQUNkbEYsS0FBSzBGLGtCQUFvQmIsRUFDekI3RSxLQUFLMkYsaUJBQW1CUCxFQUN4QnBGLEtBQUs0Rix3QkFBMEJQLEVBQy9CckYsS0FBSzZGLFNBQVc3RixLQUFLOEYsZUFDckI5RixLQUFLK0YsV0FBYS9GLEtBQUs2RixTQUFTdEUsY0FBYyxvQkFDOUN2QixLQUFLZ0csVUFBWWhHLEtBQUs2RixTQUFTdEUsY0FBYyxtQkFDN0N2QixLQUFLaUcsWUFBY2pHLEtBQUs2RixTQUFTdEUsY0FBYywwQkFDL0N2QixLQUFLa0csZ0JBQWtCbEcsS0FBSzZGLFNBQVN0RSxjQUFjLDBCQUNuRHZCLEtBQUttRyxVQUFZbkcsS0FBSzZGLFNBQVN0RSxjQUFjLHVCQUM3Q3ZCLEtBQUtvRyxJQUFNekUsRUFDWDNCLEtBQUtxRyxRQUFVdkIsRUFDZjlFLEtBQUtzRyxTQUFXdEIsRUFDaEJoRixLQUFLdUcsVUFBWXBCLEVBQ2pCbkYsS0FBS3dHLGFBQWV6QixFQUNwQi9FLEtBQUt5RyxZQUFjbkIsRUFDbkJ0RixLQUFLMEcsa0JBQW9CbkIsRUFHM0JPLGVBS0UsT0FKb0JqRCxTQUNqQnRCLGNBQWN2QixLQUFLMEYsbUJBQ25CaUIsUUFBUXBGLGNBQWMsc0JBQ3RCcUYsV0FBVSxHQUlmQyxlQVNFLE9BUkE3RyxLQUFLK0YsV0FBV2UsSUFBTTlHLEtBQUt5RixPQUMzQnpGLEtBQUtnRyxVQUFVcEUsWUFBYzVCLEtBQUt3RixNQUNsQ3hGLEtBQUsrRixXQUFXZ0IsSUFBaEIsa0JBQWlDL0csS0FBS3dGLE9BQ3RDeEYsS0FBS2tHLGdCQUFnQnRFLFlBQWM1QixLQUFLdUcsVUFDeEN2RyxLQUFLaUQsb0JBQ0xqRCxLQUFLd0csY0FBZXhHLEtBQUtnSCxtQkFDekJoSCxLQUFLcUcsVUFBWXJHLEtBQUtzRyxVQUN0QnRHLEtBQUtpRyxZQUFZMUYsYUFBYSxRQUFRLGdCQUMvQlAsS0FBSzZGLFNBR2Q1QyxvQkFDRWpELEtBQUsrRixXQUFXN0QsaUJBQWlCLFNBQVMsS0FDeENsQyxLQUFLMkYsc0JBR1AzRixLQUFLbUcsVUFBVWpFLGlCQUFpQixTQUFTLEtBQ3ZDbEMsS0FBS21HLFVBQVUvRixVQUFVZ0QsU0FBUyw2QkFDaENwRCxLQUFLMEcsa0JBQWtCMUcsTUFDdkJBLEtBQUt5RyxZQUFZekcsU0FHckJBLEtBQUtpRyxZQUFZL0QsaUJBQWlCLFNBQVMsS0FDekNsQyxLQUFLcUYsNEJBSVRBLHlCQUNFckYsS0FBSzRGLHdCQUF3QjVGLEtBQUtvRyxLQUdwQ2EsZ0JBQ0VqSCxLQUFLNkYsU0FBU3JGLFNBR2hCMEcsUUFDRSxPQUFPbEgsS0FBS29HLElBR2RZLG1CQUNFaEgsS0FBS21HLFVBQVUvRixVQUFVK0csT0FBTyw2QkFHbENDLFlBQVlDLEdBQ1ZySCxLQUFLa0csZ0JBQWdCdEUsWUFBY3lGLEdDUWhDLE1BQU1DLEVBQU0sSUFuRkosTUFDYjlILFlBQVksR0FBc0IsSUFBdEIsUUFBRStILEVBQUYsUUFBV0MsR0FBVyxFQUNoQ3hILEtBQUt5SCxTQUFXRixFQUNoQnZILEtBQUswSCxTQUFXRixFQUdsQkcsa0JBQ0UsT0FBT0MsTUFBTSxHQUFELE9BQUk1SCxLQUFLeUgsU0FBVCxVQUEyQixDQUFFRCxRQUFTeEgsS0FBSzBILFdBQ3BERyxLQUFLN0gsS0FBSzhILGdCQUdmQyxZQUFZakUsRUFBTWtFLEdBQ2hCLE9BQU9KLE1BQU0sR0FBRCxPQUFJNUgsS0FBS3lILFNBQVQsVUFBMkIsQ0FDckNRLE9BQVEsT0FDUlQsUUFBU3hILEtBQUswSCxTQUNkUSxLQUFNQyxLQUFLQyxVQUFVLENBQ25CdEUsS0FBQUEsRUFDQWtFLEtBQUFBLE1BR0RILEtBQUs3SCxLQUFLOEgsZ0JBR2ZPLGNBQWNDLEdBQ1osT0FBT1YsTUFBTSxHQUFELE9BQUk1SCxLQUFLeUgsU0FBVCxrQkFBMkJhLEdBQVUsQ0FDL0NMLE9BQVEsU0FDUlQsUUFBU3hILEtBQUswSCxXQUViRyxLQUFLN0gsS0FBSzhILGdCQUdmUyxXQUFXRCxHQUNULE9BQU9WLE1BQU0sR0FBRCxPQUFJNUgsS0FBS3lILFNBQVQsd0JBQWlDYSxHQUFVLENBQ3JETCxPQUFRLFNBQ1JULFFBQVN4SCxLQUFLMEgsV0FFYkcsS0FBSzdILEtBQUs4SCxnQkFHZlUsU0FBU0YsR0FDUCxPQUFPVixNQUFNLEdBQUQsT0FBSTVILEtBQUt5SCxTQUFULHdCQUFpQ2EsR0FBVSxDQUNyREwsT0FBUSxNQUNSVCxRQUFTeEgsS0FBSzBILFdBRWJHLEtBQUs3SCxLQUFLOEgsZ0JBR2ZXLGNBQ0UsT0FBT2IsTUFBTSxHQUFELE9BQUk1SCxLQUFLeUgsU0FBVCxhQUE4QixDQUFFRCxRQUFTeEgsS0FBSzBILFdBQ3ZERyxLQUFLN0gsS0FBSzhILGdCQUdmWSxhQUFhLEdBQTRCLElBQTVCLFdBQUVDLEVBQUYsV0FBY0MsR0FBYyxFQUN2QyxPQUFPaEIsTUFBTSxHQUFELE9BQUk1SCxLQUFLeUgsU0FBVCxhQUE4QixDQUN4Q1EsT0FBUSxRQUNSVCxRQUFTeEgsS0FBSzBILFNBQ2RRLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJ0RSxLQUFNNkUsRUFDTkUsTUFBT0QsTUFHUmYsS0FBSzdILEtBQUs4SCxnQkFHZmdCLGdCQUFnQkMsR0FDZCxPQUFPbkIsTUFBTSxHQUFELE9BQUk1SCxLQUFLeUgsU0FBVCxvQkFBcUMsQ0FDL0NRLE9BQVEsUUFDUlQsUUFBU3hILEtBQUswSCxTQUNkUSxLQUFNQyxLQUFLQyxVQUFVLENBQ25CWSxPQUFRRCxNQUdUbEIsS0FBSzdILEtBQUs4SCxnQkFHZkEsZUFBZW1CLEdBQ2IsT0FBSUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTkMsUUFBUUMsT0FBUixnQkFBd0JKLEVBQUlLLFdBSVosQ0FDekIvQixRQUFTLDhDQUNUQyxRQUFTLENBQ1ArQixjQUFlLHVDQUNmLGVBQWdCLHNCQzNEZEMsRUFBVSxJQzVCRCxNQUNiaEssWUFBWSxFQUFvQmlLLEdBQW1CLElBQXZDLEtBQUVDLEVBQUYsU0FBUUMsR0FBK0IsRUFDakQzSixLQUFLNEosV0FBYS9HLFNBQVN0QixjQUFja0ksR0FDekN6SixLQUFLNkosT0FBU0gsRUFDZDFKLEtBQUs4SixVQUFZSCxFQUduQkEsV0FDRTNKLEtBQUs2SixPQUFPNUgsU0FBUzhILElBQ25CL0osS0FBSzhKLFVBQVVDLE1BSW5CQyxRQUFRRCxHQUNOL0osS0FBSzRKLFdBQVdLLFFBQVFGLEtEZTFCLENBQ0VMLEtBQU0sR0FDTkMsU0FBV0ksSUFDVFAsRUFBUVEsUUFBUUUsYUFBYUgsTUFHakMzRixHQUdJK0YsRUFBVyxJQUFJOUcsRUFBYyxhQXFIbkMsV0FDRSxNQUFNTyxFQUFjdUcsRUFBU3hHLGlCQUN2QnNCLEVBQU9yQixFQUFZd0csWUFDbkJsRixFQUFRdEIsRUFBWXlHLGdCQUNwQk4sRUFBTyxHQUNiQSxFQUFLakcsS0FBT21CLEVBQ1o4RSxFQUFLL0IsS0FBTzlDLEVBQ1pvQyxFQUFBQSxZQUNlckMsRUFBTUMsR0FDbEIyQyxNQUFNb0IsSUFDTGMsRUFBSy9FLFFBQVVpRSxFQUFJcUIsTUFBTWxFLElBQ3pCMkQsRUFBSzNELElBQU02QyxFQUFJN0MsSUFDZjJELEVBQUtRLE1BQVF0QixFQUFJc0IsTUFDakJmLEVBQVFRLFFBQVFRLEVBQVdULElBQzNCSSxFQUFTeEgsV0FFVjhILE1BQU1DLFFBQVFDLEtBQ2RDLFNBQVEsS0FDUCxNQUFNQyxFQUFZVixFQUFTakcsU0FDM0IyRyxFQUFVakosWUFBYyxTQUN4QmlKLEVBQVV0SyxhQUFhLFFBQVMsd0JBeEloQ3VLLEVBQXNCLElBQUl6SCxFQUM5QixxQkEySUYsV0FDRSxNQUNNMkUsRUFEaUI4QyxFQUFvQm5ILGlCQUNmMEcsZ0JBQzVCL0MsRUFBQUEsZ0JBQ21CVSxHQUNoQkgsTUFBTW9CLElBQ0w2QixFQUFvQm5JLFFBQ3BCb0ksRUFBZ0JDLFlBQVkvQixNQUU3QndCLE9BQU9RLElBQ05QLFFBQVFDLElBQUlNLE1BRWJMLFNBQVEsS0FDUCxNQUFNQyxFQUFZQyxFQUFvQjVHLFNBQ3RDMkcsRUFBVWpKLFlBQWMsT0FDeEJpSixFQUFVdEssYUFBYSxRQUFTLHdCQXZKaEMySyxFQUFZLElBQUk3SCxFQUFjLGdCQWdHcEMsV0FDRSxNQUFNTyxFQUFjc0gsRUFBVXZILGlCQUM5QjJELEVBQUFBLGFBQ2dCMUQsR0FDYmlFLE1BQU1vQixJQUNMaUMsRUFBVXZJLFFBQ1ZvSSxFQUFnQkMsWUFBWS9CLE1BRTdCd0IsTUFBTUMsUUFBUUMsS0FDZEMsU0FBUSxLQUNQLE1BQU1DLEVBQVlLLEVBQVVoSCxTQUM1QjJHLEVBQVVqSixZQUFjLE9BQ3hCaUosRUFBVXRLLGFBQWEsUUFBUyx3QkEzR2hDNEssRUFBcUIsSUUxQ1osY0FBOEIzSSxFQUMzQ2hELFlBQVlpRCxHQUNWYyxNQUFNZCxHQUNOekMsS0FBS3dELGtCQUFvQnhELEtBQUs0QyxjQUFjckIsY0FBYyxnQkFHNUQ2SixhQUFhQyxHQUNYckwsS0FBSzBELGVBQWlCMkgsRUFHeEJwSSxvQkFDRU0sTUFBTU4sb0JBQ05qRCxLQUFLd0Qsa0JBQWtCdEIsaUJBQWlCLFVBQVdnQixJQUNqREEsRUFBRVgsaUJBQ0Z2QyxLQUFLMEQsc0JGNEJvQyxrQkFDekM0SCxFQUFhLElHM0NKLGNBQTZCOUksRUFDMUNoRCxZQUFZK0wsRyxRQUNWaEksTUFBTWdJLEcsRUFPRCxDQUFDckcsRUFBT0QsS0FDYmpGLEtBQUt3TCxXQUFXMUUsSUFBTTVCLEVBQ3RCbEYsS0FBS3lMLFdBQVc3SixZQUFjcUQsRUFDOUJqRixLQUFLd0wsV0FBV3pFLElBQWhCLGtCQUFpQzlCLEdBQ2pDMUIsTUFBTVQsUyxFQVp3QixlLHNCQUFBLEssdURBQUEsSyxPQUU5QjlDLEtBQUt3TCxXQUFheEwsS0FBSzRDLGNBQWNyQixjQUFjLHNCQUNuRHZCLEtBQUt5TCxXQUFhekwsS0FBSzRDLGNBQWNyQixjQUNuQyw2Qk5QcUIsZUc4Q3JCd0osRUFBa0IsSUk5Q1QsTUFDYnZMLFlBQVksR0FBd0QsSUFBeEQsYUFBRTZFLEVBQUYsYUFBZ0JDLEVBQWhCLGVBQThCb0gsRUFBOUIsT0FBOEM1RyxHQUFVLEVBQ2xFOUUsS0FBSzJMLGFBQWU5SSxTQUFTdEIsY0FBYzhDLEdBQzNDckUsS0FBSzRMLGFBQWUvSSxTQUFTdEIsY0FBYytDLEdBQzNDdEUsS0FBSzZMLGFBQWVoSixTQUFTdEIsY0FBY21LLEdBRzdDakQsY0FDRSxNQUFNcUQsRUFBVyxHQUdqQixPQUZBQSxFQUFTaEksS0FBTzlELEtBQUsyTCxhQUFhL0osWUFDbENrSyxFQUFTQyxLQUFPL0wsS0FBSzRMLGFBQWFoSyxZQUMzQmtLLEVBR1RkLFlBQVl0QixHQUNWMUosS0FBSzJMLGFBQWEvSixZQUFjOEgsRUFBSzVGLEtBQ3JDOUQsS0FBSzRMLGFBQWFoSyxZQUFjOEgsRUFBS2IsTUFDckM3SSxLQUFLNkwsYUFBYS9FLElBQU00QyxFQUFLVixTSjZCSSxDQUNuQzNFLGFBRG1DLEVBRW5DQyxhQUZtQyxFQUduQ29ILGVIN0NxQixvQkdnRGpCTSxFQUFpQixHQUNHdk0sSUFBQUEsRUFBQUEsRUhyQ1QsQ0FDZmtCLGNBQWUscUJBQ2ZFLHFCQUFzQiwwQkFDdEJDLG9CQUFxQixrQ0FDckJFLGdCQUFpQix1QkFDakJFLFdBQVksOEJBQ1orSyxhQUFjLGdCR2dDRzdLLE1BQU1DLEtBQUt3QixTQUFTdkIsaUJBQWlCN0IsRUFBU3dNLGVBQ3REaEssU0FBU3ZDLElBQ2hCLE1BQU13TSxFQUFZLElBQUkzTSxFQUFjRSxFQUFVQyxHQUN4Q3lNLEVBQVd6TSxFQUFZME0sYUFBYSxRQUMxQ0osRUFBZUcsR0FBWUQsRUFDM0JBLEVBQVU3SixzQkFLZDZJLEVBQVVqSSxvQkFDVmtILEVBQVNsSCxvQkFDVDZILEVBQW9CN0gsb0JBQ3BCa0ksRUFBbUJsSSxvQkFDbkJxSSxFQUFXckksb0JBRVgsTUFBTXVILEVBQWNULElBQ2xCLE1BQU0vRSxFQUFVK0UsRUFBSy9FLFFBQVUrRSxFQUFLL0UsUUFBVStFLEVBQUtPLE1BQU1sRSxJQUNuRG5CLEVBQU84RSxFQUFLakcsS0FDWm9CLEVBQVE2RSxFQUFLL0IsS0FDbkIsSUFBSTdDLEVBQVc0RSxFQUFLUSxNQUFNOEIsT0FDMUIsTUFBTTFLLEVBQUtvSSxFQUFLM0QsSUFDaEIsSUFBSXJCLEdBQWMsRUFDbEJnRixFQUFLUSxNQUFNdEksU0FBU3FLLElBQ2xCLEdBQUlBLEVBQUtsRyxNQUFRdEIsRUFFZixPQURBQyxHQUFjLEVBQ1BBLEtBSVgsTUFJTXdILEVBQU8sSUFBSTNILEVBQ2YsQ0FDRUcsWUFBQUEsRUFDQUMsUUFBQUEsRUFDQUMsS0FBQUEsRUFDQUMsTUFBQUEsRUFDQXZELEdBQUFBLEVBQ0F3RCxTQUFBQSxFQUNBQyxnQkFBaUIsS0FaSWtHLENBQUFBLElBQ3ZCQSxFQUFXeEksS0FBS29DLEVBQU9ELElBWW5CRyxDQUFnQmtHLElBRWxCakcsdUJBQXlCMUQsSUFDdkJ3SixFQUFtQnJJLE9BQ25CcUksRUFBbUJDLGNBQWEsS0FDOUI5RCxFQUFBQSxjQUNpQjNGLEdBQ2RrRyxNQUFNb0IsSUFDTHNELEVBQUt0RixnQkFDTGtFLEVBQW1CeEksV0FFcEI4SCxNQUFNQyxRQUFRQyxTQUdyQnJGLFdBQWFpSCxLQXVGbkIsU0FBb0JBLEdBQ2xCakYsRUFBQUEsU0FDWWlGLEVBQUtyRixTQUNkVyxNQUFNb0IsSUFDTHNELEVBQUtuRixZQUFZNkIsRUFBSXNCLE1BQU04QixRQUMzQkUsRUFBS3ZGLHNCQUVOeUQsT0FBT1EsSUFDTlAsUUFBUUMsSUFBSU0sTUE5RlYzRixDQUFXaUgsSUFFYmhILGlCQUFtQmdILEtBZ0d6QixTQUEwQkEsR0FDeEJqRixFQUFBQSxXQUNjaUYsRUFBS3JGLFNBQ2hCVyxNQUFNb0IsSUFDTHNELEVBQUtuRixZQUFZNkIsRUFBSXNCLE1BQU04QixRQUMzQkUsRUFBS3ZGLHNCQUVOeUQsT0FBT1EsSUFDTlAsUUFBUUMsSUFBSU0sTUF2R1YxRixDQUFpQmdILEtBSXJCLGlCQUNBekgsR0FHRixPQURvQnlILEVBQUsxRixnQkFJM0IsSUFBSS9CLEVBQ0pzRSxRQUFRb0QsSUFBSSxDQUFDbEYsRUFBSW1CLGNBQWVuQixFQUFJSyxvQkFDakNFLE1BQUssSUFBeUIsSUFBdkI0RSxFQUFTQyxHQUFjLEVBQzdCNUgsRUFBUzJILEVBQVFyRyxJQUNIaEYsTUFBTUMsS0FBS3FMLEdBQ25CekssU0FBU3NLLElBQ2IvQyxFQUFRUSxRQUFRUSxFQUFXK0IsT0FFN0I3QixRQUFRQyxJQUFJOEIsR0FDWjFCLEVBQWdCQyxZQUFZeUIsTUFFN0JoQyxNQUFNQyxRQUFRQyxLQXFGakJwRyxFQUFlckMsaUJBQWlCLFNBQVMsS0FDdkMsTUFBTTRKLEVBQVdmLEVBQWdCdEMsY0FDakNoRSxFQUFVbEUsYUFBYSxRQUFTdUwsRUFBU2hJLE1BQ3pDWSxFQUFVbkUsYUFBYSxRQUFTdUwsRUFBU0MsTUFDekNDLEVBQWMsV0FBZTVKLGtCQUM3QjhJLEVBQVVwSSxVQUdaMEIsRUFBY3RDLGlCQUFpQixTQUFTLEtBQ3RDOEosRUFBYyxVQUFjNUosa0JBQzVCK0gsRUFBU3JILFVBR1g2QixFQUFpQnpDLGlCQUFpQixTQUFTLEtBQ3pDOEosRUFBYyx1QkFBMkI1SixrQkFDekMwSSxFQUFvQmhJLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImN1cnNvcjpub3QtYWxsb3dlZFwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImN1cnNvcjogcG9pbnRlclwiKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfc2V0SW5wdXRzRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRJbnB1dHNFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX2FjdGl2ZVwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9hY3RpdmVcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfYWN0aXZlXCIpIHx8XHJcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2V4aXQtaWNvblwiKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0SGFuZGxlcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9mb3JtUG9wdXBFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9mb3JtUG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLnBvcHVwX19mb3JtLXN1Ym1pdC1idG5cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9XHJcbiAgICAgIHRoaXMuX2Zvcm1Qb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fZm9ybS1pbnB1dFwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBzdWJtaXRIYW5kbGVyO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dEZpZWxkcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGNvbnN0IGtleSA9IGlucHV0Lm5hbWU7XHJcbiAgICAgIGlucHV0RmllbGRzW2tleV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0RmllbGRzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybVBvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fcmVuZGVyTG9hZGluZygpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9yZW5kZXJMb2FkaW5nKCl7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi5kaWFibGVkID0gdHJ1ZTtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiY3Vyc29yOm5vdC1hbGxvd2VkXCIpO1xyXG4gIH1cclxuXHJcbiAgZ2V0QnRuKCl7XHJcbiAgICByZXR1cm4gdGhpcy5fc3VibWl0QnRuO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybVBvcHVwRWxlbWVudC5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCJjb25zdCBpbWFnZVBvcHVwU2VsZWN0b3IgPSBcIiNpbWFnZVBvcFVwXCI7XHJcbmNvbnN0IGdhbGxlcnlTZWxlY3RvciA9IFwiLmVsZW1lbnRzX19saXN0XCI7XHJcbmNvbnN0IG5hbWVTZWxlY3RvciA9IFwiLnByb2ZpbGVfX25hbWVcIjtcclxuY29uc3Qgcm9sZVNlbGVjdG9yID0gXCIucHJvZmlsZV9fcm9sZVwiO1xyXG5jb25zdCBhdmF0YXJTZWxlY3RvciA9IFwiLnByb2ZpbGVfX2ltYWdlXCI7XHJcbmNvbnN0IGNhcmRzRWxlbWVudHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihnYWxsZXJ5U2VsZWN0b3IpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XHJcbmNvbnN0IHByb2ZpbGVBZGRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW5wdXROYW1lXCIpO1xyXG5jb25zdCBpbnB1dFJvbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2lucHV0Um9sZVwiKTtcclxuY29uc3QgdXNlck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbmNvbnN0IHVzZXJSb2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihyb2xlU2VsZWN0b3IpO1xyXG5jb25zdCBsaWtlc051bUl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19saWtlc051bWJlclwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VDb250YWluZXJcIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcblxyXG5jb25zdCBzZXR0aW5ncyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybS1pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybS1zdWJtaXQtYnRuXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fZm9ybS1zdWJtaXQtYnRuX2luYWN0aXZlXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19mb3JtLWVycm9yTXNnXCIsXHJcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9fZm9ybS1lcnJvck1zZ19hY3RpdmVcIixcclxuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbn07XHJcblxyXG5leHBvcnQge1xyXG4gIHJvbGVTZWxlY3RvcixcclxuICBuYW1lU2VsZWN0b3IsXHJcbiAgYXZhdGFyU2VsZWN0b3IsXHJcbiAgaW5wdXROYW1lLFxyXG4gIGlucHV0Um9sZSxcclxuICBsaWtlc051bUl0ZW0sXHJcbiAgZWRpdFByb2ZpbGVJbWFnZSxcclxuICBzZXR0aW5ncyxcclxuICBnYWxsZXJ5U2VsZWN0b3IsXHJcbiAgdXNlck5hbWUsXHJcbiAgdXNlclJvbGUsXHJcbiAgcHJvZmlsZUltYWdlLFxyXG4gIHByb2ZpbGVBZGRCdG4sXHJcbiAgcHJvZmlsZUVkaXRCdG4sXHJcbiAgY2FyZHNFbGVtZW50c0xpc3QsXHJcbiAgaW1hZ2VQb3B1cFNlbGVjdG9yLFxyXG59O1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7IGxpa2VkQm9sVmFsLCBvd25lcklkLCB0ZXh0LCBpbWFnZSwgaWQsIGxpa2VzTnVtLCBoYW5kbGVDYXJkQ2xpY2ssIG9wZW5EZWxldGVDb25maXJtUG9wVXAsIGhhbmRsZUxpa2UsIGhhbmRsZURlbGV0ZUxpa2V9LCB0ZW1wbGF0ZVNlbGVjdG9yLCB1c2VySWQpIHtcclxuICAgIHRoaXMuX3RleHQgPSB0ZXh0O1xyXG4gICAgdGhpcy5faW1hZ2UgPSBpbWFnZTtcclxuICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5fb3BlbkRlbGV0ZUNvbmZpcm1Qb3BVcCA9IG9wZW5EZWxldGVDb25maXJtUG9wVXA7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2ltYWdlSXRlbSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19faW1hZ2VcIik7XHJcbiAgICB0aGlzLl90ZXh0SXRlbSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fdGV4dFwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUl0ZW0gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2RlbGV0ZS1pY29uXCIpO1xyXG4gICAgdGhpcy5fbGlrZU51bWJlckl0ZW0gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2xpa2VzTnVtYmVyXCIpO1xyXG4gICAgdGhpcy5fbGlrZUl0ZW0gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2xpa2UtYnRuXCIpO1xyXG4gICAgdGhpcy5faWQgPSBpZDtcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICAgIHRoaXMuX293bmVySWQgPSBvd25lcklkO1xyXG4gICAgdGhpcy5fbGlrZXNOdW0gPSBsaWtlc051bTtcclxuICAgIHRoaXMuX2xpa2VkQm9sVmFsID0gbGlrZWRCb2xWYWw7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlID0gaGFuZGxlTGlrZTtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUxpa2UgPSBoYW5kbGVEZWxldGVMaWtlO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19lbGVtZW50XCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9pbWFnZUl0ZW0uc3JjID0gdGhpcy5faW1hZ2U7XHJcbiAgICB0aGlzLl90ZXh0SXRlbS50ZXh0Q29udGVudCA9IHRoaXMuX3RleHQ7XHJcbiAgICB0aGlzLl9pbWFnZUl0ZW0uYWx0ID0gYHZpZXcgb2YgJHt0aGlzLl90ZXh0fWA7XHJcbiAgICB0aGlzLl9saWtlTnVtYmVySXRlbS50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzTnVtO1xyXG4gICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fbGlrZWRCb2xWYWwgPyB0aGlzLnRvZ2dsZUxpa2VCdXR0b24oKSA6IG51bGw7XHJcbiAgICB0aGlzLl91c2VySWQgPT09IHRoaXMuX293bmVySWQgPyBudWxsIDogXHJcbiAgICB0aGlzLl9kZWxldGVJdGVtLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsXCJkaXNwbGF5Om5vbmVcIik7IFxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2ltYWdlSXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2xpa2VJdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2xpa2VJdGVtLmNsYXNzTGlzdC5jb250YWlucyhcImVsZW1lbnRzX19zdmctaGVhcnRfbGlrZWRcIikgXHJcbiAgICAgID8gdGhpcy5faGFuZGxlRGVsZXRlTGlrZSh0aGlzKVxyXG4gICAgICA6IHRoaXMuX2hhbmRsZUxpa2UodGhpcylcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2RlbGV0ZUl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5vcGVuRGVsZXRlQ29uZmlybVBvcFVwKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG9wZW5EZWxldGVDb25maXJtUG9wVXAoKSB7XHJcbiAgICB0aGlzLl9vcGVuRGVsZXRlQ29uZmlybVBvcFVwKHRoaXMuX2lkKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZURvbUNhcmQoKXtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgfVxyXG5cclxuICBnZXRJZCgpe1xyXG4gICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlTGlrZUJ1dHRvbigpe1xyXG4gICAgdGhpcy5fbGlrZUl0ZW0uY2xhc3NMaXN0LnRvZ2dsZShcImVsZW1lbnRzX19zdmctaGVhcnRfbGlrZWRcIik7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaWtlcyhsaWtlc0NvdW50KXtcclxuICAgIHRoaXMuX2xpa2VOdW1iZXJJdGVtLnRleHRDb250ZW50ID0gbGlrZXNDb3VudDtcclxuICB9XHJcbn1cclxuXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9XHJcblxyXG4gIHBvc3ROZXdDYXJkKG5hbWUsIGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH1cclxuXHJcbiAgY29uZmlybURlbGV0ZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG5cclxuICBkZWxldGVMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9XHJcblxyXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwgeyBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBmb3JtX19uYW1lLCBmb3JtX19yb2xlIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBmb3JtX19uYW1lLFxyXG4gICAgICAgIGFib3V0OiBmb3JtX19yb2xlLFxyXG4gICAgICB9KSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG5cclxuICBlZGl0QXZhdGFySW1hZ2UoaW1hZ2VMaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogaW1hZ2VMaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImQxMTdjYTRjLTAxZWYtNGYxOS1hYmVlLTM4N2I0ZTMyZTY5ZFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aFN1Ym1pdCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanNcIjtcclxuXHJcbmltcG9ydCB7XHJcbiAgc2V0dGluZ3MsXHJcbiAgZWRpdFByb2ZpbGVJbWFnZSxcclxuICBuYW1lU2VsZWN0b3IsXHJcbiAgcm9sZVNlbGVjdG9yLFxyXG4gIGF2YXRhclNlbGVjdG9yLFxyXG4gIHByb2ZpbGVBZGRCdG4sXHJcbiAgcHJvZmlsZUVkaXRCdG4sXHJcbiAgcHJvZmlsZUltYWdlLFxyXG4gIGltYWdlUG9wdXBTZWxlY3RvcixcclxuICBnYWxsZXJ5U2VsZWN0b3IsXHJcbiAgdXNlck5hbWUsXHJcbiAgdXNlclJvbGUsXHJcbiAgaW5wdXROYW1lLFxyXG4gIGlucHV0Um9sZSxcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7IGFwaSB9IGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5cclxuY29uc3QgZ2FsbGVyeSA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGRhdGE6IFtdLFxyXG4gICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgIGdhbGxlcnkuYWRkSXRlbShjYXJkUmVuZGVyZXIoaXRlbSkpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIGdhbGxlcnlTZWxlY3RvclxyXG4pO1xyXG5cclxuY29uc3QgYWRkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhZGRJbWFnZVwiLCBoYW5kbGVDYXJkRm9ybVN1Ym1pdCk7XHJcbmNvbnN0IGVkaXRQcm9maWxlSW1nUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNlZGl0UHJvZmlsZUltYWdlXCIsXHJcbiAgaGFuZGxlRWRpdFByb2ZpbGVJbWFnZVxyXG4pO1xyXG5jb25zdCBlZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNlZGl0UHJvZmlsZVwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XHJcbmNvbnN0IGNvbmZpcm1EZWxldGVQb3BVcCA9IG5ldyBQb3B1cFdpdGhTdWJtaXQoXCIjY29uZmlybURlbGV0ZVwiKTtcclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShpbWFnZVBvcHVwU2VsZWN0b3IpO1xyXG5jb25zdCBwcm9maWxlVXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcixcclxuICByb2xlU2VsZWN0b3IsXHJcbiAgYXZhdGFyU2VsZWN0b3IsXHJcbn0pO1xyXG5cclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChzZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmZvcm1TZWxlY3RvcikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG5lZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuZWRpdFByb2ZpbGVJbWdQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25maXJtRGVsZXRlUG9wVXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgY3JlYXRlQ2FyZCA9IChpdGVtKSA9PiB7XHJcbiAgY29uc3Qgb3duZXJJZCA9IGl0ZW0ub3duZXJJZCA/IGl0ZW0ub3duZXJJZCA6IGl0ZW0ub3duZXIuX2lkO1xyXG4gIGNvbnN0IHRleHQgPSBpdGVtLm5hbWU7XHJcbiAgY29uc3QgaW1hZ2UgPSBpdGVtLmxpbms7XHJcbiAgbGV0IGxpa2VzTnVtID0gaXRlbS5saWtlcy5sZW5ndGg7XHJcbiAgY29uc3QgaWQgPSBpdGVtLl9pZDtcclxuICBsZXQgbGlrZWRCb2xWYWwgPSBmYWxzZTtcclxuICBpdGVtLmxpa2VzLmZvckVhY2goKHVzZXIpID0+IHtcclxuICAgIGlmICh1c2VyLl9pZCA9PT0gdXNlcklkKSB7XHJcbiAgICAgIGxpa2VkQm9sVmFsID0gdHJ1ZTtcclxuICAgICAgcmV0dXJuIGxpa2VkQm9sVmFsO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVDYXJkQ2xpY2sgPSAoaW1hZ2VQb3B1cCkgPT4ge1xyXG4gICAgaW1hZ2VQb3B1cC5vcGVuKGltYWdlLCB0ZXh0KTtcclxuICB9O1xyXG5cclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICB7XHJcbiAgICAgIGxpa2VkQm9sVmFsLFxyXG4gICAgICBvd25lcklkLFxyXG4gICAgICB0ZXh0LFxyXG4gICAgICBpbWFnZSxcclxuICAgICAgaWQsXHJcbiAgICAgIGxpa2VzTnVtLFxyXG4gICAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHtcclxuICAgICAgICBoYW5kbGVDYXJkQ2xpY2soaW1hZ2VQb3B1cCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIG9wZW5EZWxldGVDb25maXJtUG9wVXA6IChpZCkgPT4ge1xyXG4gICAgICAgIGNvbmZpcm1EZWxldGVQb3BVcC5vcGVuKCk7XHJcbiAgICAgICAgY29uZmlybURlbGV0ZVBvcFVwLmRlbGV0ZUFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgLmNvbmZpcm1EZWxldGUoaWQpXHJcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgICBjYXJkLmRlbGV0ZURvbUNhcmQoKTtcclxuICAgICAgICAgICAgICBjb25maXJtRGVsZXRlUG9wVXAuY2xvc2UoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSxcclxuICAgICAgaGFuZGxlTGlrZTogKGNhcmQpID0+IHtcclxuICAgICAgICBoYW5kbGVMaWtlKGNhcmQpO1xyXG4gICAgICB9LFxyXG4gICAgICBoYW5kbGVEZWxldGVMaWtlOiAoY2FyZCkgPT4ge1xyXG4gICAgICAgIGhhbmRsZURlbGV0ZUxpa2UoY2FyZCk7XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIHVzZXJJZFxyXG4gICk7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufTtcclxuXHJcbmxldCB1c2VySWQ7XHJcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAudGhlbigoW3Jlc1VzZXIsIHJlc0NhcmRzXSkgPT4ge1xyXG4gICAgdXNlcklkID0gcmVzVXNlci5faWQ7XHJcbiAgICBjb25zdCBjYXJkcyA9IEFycmF5LmZyb20ocmVzQ2FyZHMpO1xyXG4gICAgY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xyXG4gICAgICBnYWxsZXJ5LmFkZEl0ZW0oY3JlYXRlQ2FyZChjYXJkKSk7XHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKHJlc1VzZXIpO1xyXG4gICAgcHJvZmlsZVVzZXJJbmZvLnNldFVzZXJJbmZvKHJlc1VzZXIpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KCkge1xyXG4gIGNvbnN0IGlucHV0RmllbGRzID0gZWRpdFBvcHVwLmdldElucHV0VmFsdWVzKCk7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFVzZXJJbmZvKGlucHV0RmllbGRzKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBlZGl0UG9wdXAuY2xvc2UoKTtcclxuICAgICAgcHJvZmlsZVVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUubG9nKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBjb25zdCBzdWJtaXRCdG4gPSBlZGl0UG9wdXAuZ2V0QnRuKCk7XHJcbiAgICAgIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgICBzdWJtaXRCdG4uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJjdXJzb3I6cG9pbnRlclwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkRm9ybVN1Ym1pdCgpIHtcclxuICBjb25zdCBpbnB1dEZpZWxkcyA9IGFkZFBvcHVwLmdldElucHV0VmFsdWVzKCk7XHJcbiAgY29uc3QgdGV4dCA9IGlucHV0RmllbGRzLmZvcm1fX3RpdGxlO1xyXG4gIGNvbnN0IGltYWdlID0gaW5wdXRGaWVsZHMuZm9ybV9faW1hZ2VMaW5rO1xyXG4gIGNvbnN0IGl0ZW0gPSB7fTtcclxuICBpdGVtLm5hbWUgPSB0ZXh0O1xyXG4gIGl0ZW0ubGluayA9IGltYWdlO1xyXG4gIGFwaVxyXG4gICAgLnBvc3ROZXdDYXJkKHRleHQsIGltYWdlKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpdGVtLm93bmVySWQgPSByZXMub3duZXIuX2lkO1xyXG4gICAgICBpdGVtLl9pZCA9IHJlcy5faWQ7XHJcbiAgICAgIGl0ZW0ubGlrZXMgPSByZXMubGlrZXM7XHJcbiAgICAgIGdhbGxlcnkuYWRkSXRlbShjcmVhdGVDYXJkKGl0ZW0pKTtcclxuICAgICAgYWRkUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHN1Ym1pdEJ0biA9IGFkZFBvcHVwLmdldEJ0bigpO1xyXG4gICAgICBzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBcIkNyZWF0ZVwiO1xyXG4gICAgICBzdWJtaXRCdG4uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJjdXJzb3I6cG9pbnRlclwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZUltYWdlKCkge1xyXG4gIGNvbnN0IGlucHV0TGlua0ZpZWxkID0gZWRpdFByb2ZpbGVJbWdQb3B1cC5nZXRJbnB1dFZhbHVlcygpO1xyXG4gIGNvbnN0IGxpbmsgPSBpbnB1dExpbmtGaWVsZC5mb3JtX19pbWFnZUxpbms7XHJcbiAgYXBpXHJcbiAgICAuZWRpdEF2YXRhckltYWdlKGxpbmspXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGVkaXRQcm9maWxlSW1nUG9wdXAuY2xvc2UoKTtcclxuICAgICAgcHJvZmlsZVVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHN1Ym1pdEJ0biA9IGVkaXRQcm9maWxlSW1nUG9wdXAuZ2V0QnRuKCk7XHJcbiAgICAgIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgICBzdWJtaXRCdG4uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJjdXJzb3I6cG9pbnRlclwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlKGNhcmQpIHtcclxuICBhcGlcclxuICAgIC5saWtlQ2FyZChjYXJkLmdldElkKCkpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzLmxlbmd0aCk7XHJcbiAgICAgIGNhcmQudG9nZ2xlTGlrZUJ1dHRvbigpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlTGlrZShjYXJkKSB7XHJcbiAgYXBpXHJcbiAgICAuZGVsZXRlTGlrZShjYXJkLmdldElkKCkpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzLmxlbmd0aCk7XHJcbiAgICAgIGNhcmQudG9nZ2xlTGlrZUJ1dHRvbigpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5cclxucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCB1c2VyRGF0YSA9IHByb2ZpbGVVc2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGlucHV0TmFtZS5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLCB1c2VyRGF0YS5uYW1lKTtcclxuICBpbnB1dFJvbGUuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgdXNlckRhdGEucm9sZSk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJlZGl0X19mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiYWRkX19mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGFkZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5lZGl0UHJvZmlsZUltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJlZGl0UHJvZmlsZUltYWdlX19mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRQcm9maWxlSW1nUG9wdXAub3BlbigpO1xyXG59KTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBkYXRhLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGRhdGE7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyZXIoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoU3VibWl0IGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZm9ybVBvcHVwRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQWN0aW9uKGFjdGlvbil7XHJcbiAgICB0aGlzLl9zdWJtaXRIYW5kbGVyID0gYWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybVBvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fc3VibWl0SGFuZGxlcigpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoaW1hZ2VQb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihpbWFnZVBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2VGaWxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlUG9wVXBcIik7XHJcbiAgICB0aGlzLl9pbWFnZVRleHQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucG9wdXBfX2ltYWdlUG9wVXAtdGV4dFwiXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgb3BlbiA9IChpbWFnZSwgdGV4dCkgPT4ge1xyXG4gICAgdGhpcy5faW1hZ2VGaWxlLnNyYyA9IGltYWdlO1xyXG4gICAgdGhpcy5faW1hZ2VUZXh0LnRleHRDb250ZW50ID0gdGV4dDtcclxuICAgIHRoaXMuX2ltYWdlRmlsZS5hbHQgPSBgdmlldyBvZiAke3RleHR9YDtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9O1xyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgcm9sZVNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciwgdXNlcklkIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcHJvZmlsZVJvbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHJvbGVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCB1c2VyRGF0YSA9IHt9O1xyXG4gICAgdXNlckRhdGEubmFtZSA9IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gICAgdXNlckRhdGEucm9sZSA9IHRoaXMuX3Byb2ZpbGVSb2xlLnRleHRDb250ZW50O1xyXG4gICAgcmV0dXJuIHVzZXJEYXRhO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oZGF0YSkge1xyXG4gICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9wcm9maWxlUm9sZS50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICB0aGlzLl9hdmF0YXJJbWFnZS5zcmMgPSBkYXRhLmF2YXRhcjtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJpbnB1dExpc3QiLCJzb21lIiwiaW5wdXRFbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsInRoaXMiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0TGlzdCIsIl9idXR0b25FbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsInF1ZXJ5U2VsZWN0b3IiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsInRleHRDb250ZW50IiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkYXRpb25NZXNzYWdlIiwiX3NldElucHV0c0V2ZW50TGlzdGVuZXJzIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJyZXNldFZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJrZXkiLCJjbG9zZSIsIl9wb3B1cEVsZW1lbnQiLCJkb2N1bWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwic3VibWl0SGFuZGxlciIsInN1cGVyIiwiX2Zvcm1Qb3B1cEVsZW1lbnQiLCJfc3VibWl0QnRuIiwiX3N1Ym1pdEhhbmRsZXIiLCJnZXRJbnB1dFZhbHVlcyIsImlucHV0RmllbGRzIiwiaW5wdXQiLCJuYW1lIiwidmFsdWUiLCJfcmVuZGVyTG9hZGluZyIsImRpYWJsZWQiLCJnZXRCdG4iLCJyZXNldCIsImdhbGxlcnlTZWxlY3RvciIsIm5hbWVTZWxlY3RvciIsInJvbGVTZWxlY3RvciIsInByb2ZpbGVFZGl0QnRuIiwicHJvZmlsZUFkZEJ0biIsImlucHV0TmFtZSIsImlucHV0Um9sZSIsImVkaXRQcm9maWxlSW1hZ2UiLCJDYXJkIiwidGVtcGxhdGVTZWxlY3RvciIsInVzZXJJZCIsImxpa2VkQm9sVmFsIiwib3duZXJJZCIsInRleHQiLCJpbWFnZSIsImxpa2VzTnVtIiwiaGFuZGxlQ2FyZENsaWNrIiwib3BlbkRlbGV0ZUNvbmZpcm1Qb3BVcCIsImhhbmRsZUxpa2UiLCJoYW5kbGVEZWxldGVMaWtlIiwiX3RleHQiLCJfaW1hZ2UiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfb3BlbkRlbGV0ZUNvbmZpcm1Qb3BVcCIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiX2ltYWdlSXRlbSIsIl90ZXh0SXRlbSIsIl9kZWxldGVJdGVtIiwiX2xpa2VOdW1iZXJJdGVtIiwiX2xpa2VJdGVtIiwiX2lkIiwiX3VzZXJJZCIsIl9vd25lcklkIiwiX2xpa2VzTnVtIiwiX2xpa2VkQm9sVmFsIiwiX2hhbmRsZUxpa2UiLCJfaGFuZGxlRGVsZXRlTGlrZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZW5lcmF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJ0b2dnbGVMaWtlQnV0dG9uIiwiZGVsZXRlRG9tQ2FyZCIsImdldElkIiwidG9nZ2xlIiwidXBkYXRlTGlrZXMiLCJsaWtlc0NvdW50IiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiX2NoZWNrUmVzcG9uc2UiLCJwb3N0TmV3Q2FyZCIsImxpbmsiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImNvbmZpcm1EZWxldGUiLCJjYXJkSWQiLCJkZWxldGVMaWtlIiwibGlrZUNhcmQiLCJnZXRVc2VySW5mbyIsImVkaXRVc2VySW5mbyIsImZvcm1fX25hbWUiLCJmb3JtX19yb2xlIiwiYWJvdXQiLCJlZGl0QXZhdGFySW1hZ2UiLCJpbWFnZUxpbmsiLCJhdmF0YXIiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiYXV0aG9yaXphdGlvbiIsImdhbGxlcnkiLCJjb250YWluZXJTZWxlY3RvciIsImRhdGEiLCJyZW5kZXJlciIsIl9jb250YWluZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJjYXJkUmVuZGVyZXIiLCJhZGRQb3B1cCIsImZvcm1fX3RpdGxlIiwiZm9ybV9faW1hZ2VMaW5rIiwib3duZXIiLCJsaWtlcyIsImNyZWF0ZUNhcmQiLCJjYXRjaCIsImNvbnNvbGUiLCJsb2ciLCJmaW5hbGx5Iiwic3VibWl0QnRuIiwiZWRpdFByb2ZpbGVJbWdQb3B1cCIsInByb2ZpbGVVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiZXJyIiwiZWRpdFBvcHVwIiwiY29uZmlybURlbGV0ZVBvcFVwIiwiZGVsZXRlQWN0aW9uIiwiYWN0aW9uIiwiaW1hZ2VQb3B1cCIsImltYWdlUG9wdXBTZWxlY3RvciIsIl9pbWFnZUZpbGUiLCJfaW1hZ2VUZXh0IiwiYXZhdGFyU2VsZWN0b3IiLCJfcHJvZmlsZU5hbWUiLCJfcHJvZmlsZVJvbGUiLCJfYXZhdGFySW1hZ2UiLCJ1c2VyRGF0YSIsInJvbGUiLCJmb3JtVmFsaWRhdG9ycyIsImZvcm1TZWxlY3RvciIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwibGVuZ3RoIiwidXNlciIsImNhcmQiLCJhbGwiLCJyZXNVc2VyIiwicmVzQ2FyZHMiXSwic291cmNlUm9vdCI6IiJ9